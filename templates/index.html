<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Blarry AI</title>
<style>
  body{font-family:Segoe UI,Arial;margin:0;background:#0f1720;color:#e6eef3;display:flex;flex-direction:column;align-items:center;height:100vh}
  h1{color:#00bcd4;margin:18px 0}
  .modes{display:flex;gap:8px;margin-bottom:12px}
  .mode-btn{background:#22313a;border:1px solid #2e4a52;color:#cfe8ec;padding:8px 12px;border-radius:8px;cursor:pointer}
  .mode-btn.active{background:#00bcd4;color:#042226;box-shadow:0 6px 18px rgba(0,188,212,0.18);transform:translateY(-2px)}
  #chat-box{width:92%;max-width:820px;height:62vh;background:#081018;border-radius:10px;padding:14px;overflow:auto;border:1px solid #12323a}
  .message{margin:10px 0;line-height:1.4}
  .user{color:#88f1ff;text-align:right}
  .bot{color:#dfeff1;text-align:left}
  #input-area{display:flex;width:92%;max-width:820px;margin-top:12px}
  #user-input{flex:1;padding:12px;border-radius:8px 0 0 8px;border:none}
  #send-btn{padding:12px 18px;border-radius:0 8px 8px 0;border:none;background:#00bcd4;color:#032;cursor:pointer}
</style>
</head>
<body>
  <h1>Blarry AI</h1>

  <div class="modes">
    <button id="btn-casual" class="mode-btn active" onclick="setMode('casual')">üí¨ Casual</button>
    <button id="btn-gaming" class="mode-btn" onclick="setMode('gaming')">üéÆ Gaming</button>
  </div>

  <div id="chat-box"></div>

  <div id="input-area">
    <input id="user-input" type="text" placeholder="Pergunte algo..." onkeypress="if(event.key==='Enter') sendMessage()">
    <button id="send-btn" onclick="sendMessage()">Enviar</button>
  </div>

<script>
let currentMode = 'casual';
const chatBox = document.getElementById('chat-box');
const btnCasual = document.getElementById('btn-casual');
const btnGaming = document.getElementById('btn-gaming');

function setMode(mode){
  currentMode = mode;
  if(mode === 'casual'){
    btnCasual.classList.add('active');
    btnGaming.classList.remove('active');
    addMessage('bot','üí¨ Modo Casual ativado ‚Äî respostas naturais e explicativas.');
  } else {
    btnGaming.classList.add('active');
    btnCasual.classList.remove('active');
    addMessage('bot','üéÆ Modo Gaming ativado ‚Äî foco em dicas, mec√¢nicas e guias.');
  }
}

function addMessage(sender,text){
  const d = document.createElement('div');
  d.className = 'message ' + (sender === 'user' ? 'user' : 'bot');
  d.textContent = text;
  chatBox.appendChild(d);
  chatBox.scrollTop = chatBox.scrollHeight;
}

async function sendMessage(){
  const input = document.getElementById('user-input');
  const text = input.value.trim();
  if(!text) return;
  addMessage('user', text);
  input.value = '';
  addMessage('bot', '‚è≥ Blarry est√° pesquisando...');
  try{
    const res = await fetch('/ask', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ question: text, mode: currentMode })
    });
    const data = await res.json();
    // remove the last "thinking" bot message
    const bots = Array.from(document.querySelectorAll('.message.bot'));
    if(bots.length) bots[bots.length-1].remove();
    addMessage('bot', data.answer || 'Desculpe, n√£o encontrei uma resposta.');
  }catch(err){
    addMessage('bot','‚ùå Erro ao contatar o servidor.');
    console.error(err);
  }
}
</script>
</body>
</html>

